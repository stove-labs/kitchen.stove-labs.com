(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{123:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return c})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return i})),a.d(t,"default",(function(){return p}));var n=a(2),r=a(6),o=(a(0),a(163)),c=(a(216),a(217),{id:"gas-fees",title:"Gas & Fees"}),s={id:"knowledge/tezos_protocol/operations/gas-fees",isDocsHomePage:!1,title:"Gas & Fees",description:'Every transaction on Tezos incurs costs for its computation and used storage. Consider that every node is performing the calculation and keeps a copy of the data. That\'s why it is necessary to provide an incentive for node operators to run the infrastructure. This is done by charging a fee paid in the native crypto currency \ua729. A nice side effect of this is that it encourages developers to write "lean" code.',source:"@site/docs/knowledge/tezos_protocol/operations/gas-fees.mdx",permalink:"/docs/knowledge/tezos_protocol/operations/gas-fees",editUrl:"https://github.com/stove-labs/learn.stove-labs.com/edit/master/website/docs/knowledge/tezos_protocol/operations/gas-fees.mdx",sidebar:"wiki",previous:{title:"Overview",permalink:"/docs/knowledge/tezos_protocol/operations/operations"},next:{title:"Revelation",permalink:"/docs/knowledge/tezos_protocol/operations/reveal-operation"}},i=[{value:"Burn \ud83d\udd25",id:"burn-",children:[]},{value:"Gas \u26fd\ufe0f",id:"gas-\ufe0f",children:[]},{value:"Calculating total fee \ud83d\udcb5",id:"calculating-total-fee-",children:[]}],b={rightToc:i};function p(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Every ",Object(o.b)("strong",{parentName:"p"},"transaction")," on Tezos ",Object(o.b)("strong",{parentName:"p"},"incurs costs")," for its ",Object(o.b)("strong",{parentName:"p"},"computation and used storage"),". Consider that every ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../node"}),"node")," is performing the calculation and keeps a copy of the data. That's why it is necessary to provide an ",Object(o.b)("strong",{parentName:"p"},"incentive for node operators")," to run the infrastructure. This is done by charging a fee ",Object(o.b)("strong",{parentName:"p"},"paid in the native crypto currency \ua729"),'. A nice side effect of this is that it encourages developers to write "lean" code.'),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"Basics")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"1 \ua729 = 1 tez = 1 XTZ = 1,000,000 mutez"))),Object(o.b)("h2",{id:"burn-"},"Burn \ud83d\udd25"),Object(o.b)("p",null,"Whenever a ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"transaction"}),"transaction")," increases the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../context"}),"context")," of the blockchain, the ",Object(o.b)("strong",{parentName:"p"},"source address must pay a burn"),".\nThe two different types of burn fee are:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Allocation burn of 0.257 \ua729 or 257,000 mutez",Object(o.b)("ol",{parentName:"li"},Object(o.b)("li",{parentName:"ol"},"Activation of a new address happens when the first transaction is sent to it",Object(o.b)("sup",Object(n.a)({parentName:"li"},{id:"fnref-1"}),Object(o.b)("a",Object(n.a)({parentName:"sup"},{href:"#fn-1",className:"footnote-ref"}),"1")),". "),Object(o.b)("li",{parentName:"ol"},"A ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"../../smart_contract/smart-contract"}),"smart contract")," is created. A new ",Object(o.b)("inlineCode",{parentName:"li"},"KT1")," address is ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"../account"}),"originated"),"."))),Object(o.b)("li",{parentName:"ol"},"Storage burn: the size of the smart contract increases.")),Object(o.b)("h2",{id:"gas-\ufe0f"},"Gas \u26fd\ufe0f"),Object(o.b)("p",null,"In short, gas is a ",Object(o.b)("strong",{parentName:"p"},"measure")," for ",Object(o.b)("strong",{parentName:"p"},"how long")," it takes a program ",Object(o.b)("strong",{parentName:"p"},"to compute"),". It is a rough equivalent of computational steps required to calculate the new ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../context"}),"state"),". This limitation prevents programs in the form of ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../../smart_contract/smart-contract"}),"smart contracts")," to run uncontrollably. "),Object(o.b)("p",null,"Consider the case of a smart contract that runs recursively. If there would be nothing to stop the program from running, many contracts could clog up the blockchain network. That's why a gas limit needs to be paid for every transaction. If the total gas used by the ",Object(o.b)("strong",{parentName:"p"},"smart contract computation is less or equal the gas limit"),", then the ",Object(o.b)("strong",{parentName:"p"},"transaction is processed")," and changes are applied to the state. However, if the total ",Object(o.b)("strong",{parentName:"p"},"gas used is higher")," than the ",Object(o.b)("strong",{parentName:"p"},"gas limit")," paid previously, then all ",Object(o.b)("strong",{parentName:"p"},"changes are reverted"),", but the gas fee is collected by the baker. In other words, the transaction is still valid, but has no effect on the state. It is the ",Object(o.b)("strong",{parentName:"p"},"responsibility of the sender to include enough gas")," for the transaction."),Object(o.b)("h2",{id:"calculating-total-fee-"},"Calculating total fee \ud83d\udcb5"),Object(o.b)("p",null,"The most ",Object(o.b)("strong",{parentName:"p"},"reliable way to determine")," the total fee that has to be paid for any ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"operations"}),"operation")," is done by running a ",Object(o.b)("strong",{parentName:"p"},"simulation in the node"),". The node simulates the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../../smart_contract/michelson"}),"Michelson")," code execution and traces the amount of gas used for computation and how much storage was required. This value is not used as final fee limit, but another 100 extra ",Object(o.b)("em",{parentName:"p"},"units of gas")," are added as buffer. It is ",Object(o.b)("strong",{parentName:"p"},"not a problem")," sending ",Object(o.b)("strong",{parentName:"p"},"too much gas")," with a transaction, because the transaction initiator will ",Object(o.b)("strong",{parentName:"p"},"receive back the surplus")," of gas."),Object(o.b)("p",null,"Nevertheless, it is useful to understand how the fee per operation is computed. In the protocol update ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://tezos.gitlab.io/protocols/004_Pt24m4xi.html"}),"004_Athens")," the constants were updated, but the formula has not changed:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"total_cost = burn + fees + amount of tez\n\nburn = storage_difference * MINIMAL_FEE_PER_STORAGE_BYTE_MUTEZ\n\nfees >= MINIMAL_FEE_MUTEZ +\n        MINIMAL_FEE_PER_BYTE_MUTEZ * size +\n        MINIMAL_FEE_PER_GAS_MUTEZ * gas\n\nin practice:\n\nfees in mutez >= 100 +\n                 1 * size +\n                 0.1 * gas\n")),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"We can use the ",Object(o.b)("inlineCode",{parentName:"p"},".estimate")," function of ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../../references/taquito"}),"Taquito")," to simulate operations in the node. It reliably traces gas and storage costs that are used for the ",Object(o.b)("inlineCode",{parentName:"p"},"_gasLimit")," and ",Object(o.b)("inlineCode",{parentName:"p"},"_storageLimit")," property of the transaction object. After adding a small safety limit (gas buffer), the transaction is ready to be announced to a live network. In this way you will avoid erroneous transactions, where the computation runs out of gas before final execution.  "))),Object(o.b)("p",null,"Taquito uses the following constants",Object(o.b)("sup",Object(n.a)({parentName:"p"},{id:"fnref-2"}),Object(o.b)("a",Object(n.a)({parentName:"sup"},{href:"#fn-2",className:"footnote-ref"}),"2"))," for estimation:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"const MINIMAL_FEE_MUTEZ = 100;\nconst MINIMAL_FEE_PER_BYTE_MUTEZ = 1;\nconst MINIMAL_FEE_PER_STORAGE_BYTE_MUTEZ = 1000;\nconst MINIMAL_FEE_PER_GAS_MUTEZ = 0.1;\nconst GAS_BUFFER = 100;\n")),Object(o.b)("p",null,"We can also go to the source code of the Tezos protocol for the constants (",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://gitlab.com/nomadic-labs/tezos/-/blob/proto-006/src/proto_alpha/lib_parameters/default_parameters.ml#L51"}),"default_parameters.ml"),") ",Object(o.b)("inlineCode",{parentName:"p"},"cost_per_byte = Tez_repr.of_mutez_exn 1_000L;"),"."),Object(o.b)("p",null,"Below are two examples of estimating the operation costs using Taquito. We will see that there is a difference of 257,000 mutez or 0.257 tez, because of the storage burn necessary for activating an account (receiving the first transaction):"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Transfer of 1 \ua729 to an inactive",Object(o.b)("sup",Object(n.a)({parentName:"strong"},{id:"fnref-1"}),Object(o.b)("a",Object(n.a)({parentName:"sup"},{href:"#fn-1",className:"footnote-ref"}),"1")))," implicit ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"account"}),"account")),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"_gasLimit : 10207 gas units\n_storageLimit : 257 bytes\nopSize : ~88 bytes\nbaseFeeMutez : 100 mutez\n")),Object(o.b)("p",null,"The ",Object(o.b)("strong",{parentName:"p"},"total cost")," for this operation was after execution ",Object(o.b)("strong",{parentName:"p"},"1.258319 \ua729"),"."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Transfer of 1 \ua729 to an active")," implicit or originated account."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"_gasLimit : 10207 gas units\n_storageLimit : 0 bytes\nopSize : ~88 bytes\nbaseFeeMutez : 100 mutez\n")),Object(o.b)("p",null,"The ",Object(o.b)("strong",{parentName:"p"},"total cost")," for this operation was after execution ",Object(o.b)("strong",{parentName:"p"},"1.001319 \ua729"),". "),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"A ",Object(o.b)("strong",{parentName:"p"},"fee")," is ",Object(o.b)("strong",{parentName:"p"},"paid")," to a ",Object(o.b)("em",{parentName:"p"},"baker"),", while a ",Object(o.b)("strong",{parentName:"p"},"burn")," is ",Object(o.b)("strong",{parentName:"p"},"destroyed"),". The latter has a deflationary quality for the total supply of \ua729, because no account is the recipient -  not even a ",Object(o.b)("em",{parentName:"p"},"baker"),"."))),Object(o.b)("div",{className:"footnotes"},Object(o.b)("hr",{parentName:"div"}),Object(o.b)("ol",{parentName:"div"},Object(o.b)("li",Object(n.a)({parentName:"ol"},{id:"fn-1"}),"The public key for an address is ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"reveal-operation"}),Object(o.b)("em",{parentName:"a"},"revealed"))," when a the first transaction is sent from it. This is important for other participants to verify operations signed by that public key.",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#fnref-1",className:"footnote-backref"}),"\u21a9")),Object(o.b)("li",Object(n.a)({parentName:"ol"},{id:"fn-2"}),"Taquito SDK ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/ecadlabs/taquito/blob/81ae43be06f1be03bda17dac125ca0ad04c39a13/packages/taquito/src/contract/estimate.ts#L1-L4"}),"estimate.ts")," ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#fnref-2",className:"footnote-backref"}),"\u21a9")))))}p.isMDXComponent=!0},163:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return f}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var b=r.a.createContext({}),p=function(e){var t=r.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},l=function(e){var t=p(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,b=i(e,["components","mdxType","originalType","parentName"]),l=p(a),m=n,f=l["".concat(c,".").concat(m)]||l[m]||u[m]||o;return a?r.a.createElement(f,s(s({ref:t},b),{},{components:a})):r.a.createElement(f,s({ref:t},b))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,c=new Array(o);c[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:n,c[1]=s;for(var b=2;b<o;b++)c[b]=a[b];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},172:function(e,t,a){"use strict";function n(e){var t,a,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=n(e[t]))&&(r&&(r+=" "),r+=a);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,a=0,r="";a<arguments.length;)(e=arguments[a++])&&(t=n(e))&&(r&&(r+=" "),r+=t);return r}},186:function(e,t,a){"use strict";var n=a(0);const r=Object(n.createContext)({tabGroupChoices:{},setTabGroupChoices:()=>{},isAnnouncementBarClosed:!1,closeAnnouncementBar:()=>{}});t.a=r},187:function(e,t,a){"use strict";var n=a(0),r=a(186);t.a=function(){return Object(n.useContext)(r.a)}},216:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(187),c=a(172),s=a(92),i=a.n(s);const b=37,p=39;t.a=function(e){const{block:t,children:a,defaultValue:s,values:l,groupId:u}=e,{tabGroupChoices:m,setTabGroupChoices:f}=Object(o.a)(),[d,h]=Object(n.useState)(s);if(null!=u){const e=m[u];null!=e&&e!==d&&l.some(t=>t.value===e)&&h(e)}const O=e=>{h(e),null!=u&&f(u,e)},j=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(c.a)("tabs",{"tabs--block":t})},l.map(({value:e,label:t})=>r.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":d===e,className:Object(c.a)("tabs__item",i.a.tabItem,{"tabs__item--active":d===e}),key:e,ref:e=>j.push(e),onKeyDown:e=>((e,t,a)=>{switch(a.keyCode){case p:((e,t)=>{const a=e.indexOf(t)+1;e[a]?e[a].focus():e[0].focus()})(e,t);break;case b:((e,t)=>{const a=e.indexOf(t)-1;e[a]?e[a].focus():e[e.length-1].focus()})(e,t)}})(j,e.target,e),onFocus:()=>O(e),onClick:()=>O(e)},t))),r.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},n.Children.toArray(a).filter(e=>e.props.value===d)[0]))}},217:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){return r.a.createElement("div",null,e.children)}}}]);